(window.webpackJsonpebay=window.webpackJsonpebay||[]).push([[0],{49:function(e,t,r){e.exports=r.p+"static/media/logo.bc6729bc.png"},67:function(e,t,r){e.exports=r(80)},72:function(e,t,r){},73:function(e,t,r){},80:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),i=r(8),o=r.n(i),s=(r(72),r(56)),c=r(16),l=r(57),u=r(48),d=r(58),m=r(49),p=r.n(m),h=(r(73),r(117)),f=r(126),g=r(125),v=r(123),C=r(112),E=r(119),P=r(129),b=r(120),w=r(127),y=r(124),L=r(121),N=r(122),B=r(128),D=r(130),O=r(118),k=r(53),Y=r.n(k),M=r(54),H=r.n(M),S=r(55),T=r.n(S),F=r(50),j=r.n(F),x=r(25),z=r.n(x),I=new function e(){var t=this;Object(c.a)(this,e),this.validateCreditLimit=function(e,r){return isNaN(r)?t.logError(e,"credit limit",r):void 0},this.validatePhoneNumber=function(e,r){var a=r.match(/^[+\-0-9(). ]+$/);return a&&r===a[0]?void 0:t.logError(e,"phone number",r)},this.validateBirthday=function(e,r,a){return"Invalid Date"===z.a.parse(r,a).toString()?t.logError(e,"birthday",r):void 0},this.logError=function(e,t,r){var a=e+" has invalid "+t+" ("+r+") and is skipped";return console.log(a),a}},R=new function e(){var t=this;Object(c.a)(this,e),this.parse=function(e,r){j()().fromString(e).then((function(e){r(t.postProcess(e))}))},this.postProcess=function(e){var t=[],r=[];return e.forEach((function(e){var a=I.validateCreditLimit(e.Name,e["Credit Limit"]);if(a)t.push(a);else if(a=I.validatePhoneNumber(e.Name,e.Phone))t.push(a);else if(a=I.validateBirthday(e.Name,e.Birthday,"DD/MM/YYYY"))t.push(a);else{var n=z.a.parse(e.Birthday,"DD/MM/YYYY");e.Birthday=n.toDateString(),e["Credit Limit"]={amount:e["Credit Limit"],source:"csv"},r.push(e)}})),{rawPersons:r,errors:t}},this.getFileType=function(){return"csv"}},A=["Name","Address","Postcode","Phone","Credit Limit","Birthday"],U=new function e(){var t=this;Object(c.a)(this,e),this.parse=function(e,r){for(var a=e.split("\n"),n=a[0],i=[],o=[],s=0;s<A.length;s++)i.push({start:0===s?0:i[s-1].end,end:s===A.length-1?n.length:n.indexOf(A[s+1])});for(s=1;s<a.length;s++)if(a[s]){for(var c={},l=0;l<A.length;l++){var u=a[s].substring(i[l].start,i[l].end).trim();c[A[l]]="Credit Limit"===A[l]?{amount:u,source:"prn"}:u}o.push(c)}r(t.postProcess(o))},this.postProcess=function(e){var t=[],r=[];return e.forEach((function(e){var a=I.validateCreditLimit(e.Name,e["Credit Limit"].amount);if(a)t.push(a);else if(a=I.validatePhoneNumber(e.Name,e.Phone))t.push(a);else if(a=I.validateBirthday(e.Name,e.Birthday,"YYYYMMDD"))t.push(a);else{var n=z.a.parse(e.Birthday,"YYYYMMDD");e.Birthday=n.toDateString(),r.push(e)}})),{rawPersons:r,errors:t}},this.getFileType=function(){return"prn"}},J=new function e(){Object(c.a)(this,e),this.getFileParser=function(e){switch(e){case"prn":return U;default:return R}}},W=["Name","Address","Postcode","Phone","Credit Limit","Origin","Birthday"],$=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(l.a)(this,Object(u.a)(t).call(this,e))).render=function(){return n.a.createElement("div",{className:"App"},n.a.createElement("header",{className:"App-header"},n.a.createElement("img",{src:p.a,className:"App-logo",alt:"logo"}),n.a.createElement(C.a,{variant:"caption",className:"Text"},"Credit limit portal"),r.renderUploadButton(),r.renderPersonTable(),r.renderDownloadHtmlButton(),r.renderErrorMessages()))},r.renderUploadButton=function(){return n.a.createElement("div",{className:"UploadButton"},n.a.createElement("input",{className:"UploadInput",accept:".csv,.prn",id:"contained-button-file",multiple:!0,type:"file",onChange:r.processFiles}),n.a.createElement("label",{htmlFor:"contained-button-file"},n.a.createElement(D.a,{title:"Upload credit limit data"},n.a.createElement(h.a,{component:"span",color:"primary","aria-label":"Add"},n.a.createElement(Y.a,null)))))},r.processFiles=function(e,t){r.processFile(e.target.files,0,t)},r.processFile=function(e,t,a){if(!(t>=e.length)){var n=e[t],i=n.name.substr(n.name.length-3),o=new FileReader;o.onload=function(n){var o=n.target.result;J.getFileParser(i).parse(o,(function(n){return r.storeParsingResultInMemory(n,(function(){a&&a[t]&&a[t](),r.processFile(e,t+1,a)}))}))},o.readAsText(n)}},r.storeParsingResultInMemory=function(e,t){var a=r.state.personCache;e.rawPersons.forEach((function(e){a.has(e.Name)?r.updatePerson(e,a):(e["Credit Limit"]=[e["Credit Limit"]],a.set(e.Name,e))})),r.setState({personCache:a,errors:e.errors},t)},r.updatePerson=function(e,t){var r=t.get(e.Name);if(r){var a=e["Credit Limit"],n=!1;r["Credit Limit"].forEach((function(e){e.source===a.source&&(e.amount=a.amount,n=!0)})),n||(1!==r["Credit Limit"].length||r["Credit Limit"][0].amount!==a.amount?r["Credit Limit"].push(a):r["Credit Limit"][0].source=r["Credit Limit"][0].source+", "+a.source)}},r.renderPersonTable=function(){if(r.personCacheHasData())return n.a.createElement(O.a,{in:r.personCacheHasData()},n.a.createElement(E.a,null,n.a.createElement(b.a,{id:"personsTable"},n.a.createElement(L.a,null,n.a.createElement(N.a,null,r.renderHeaders())),r.renderTableBody()),n.a.createElement(B.a,{component:"div",count:r.state.personCache.size,rowsPerPageOptions:[5,10,20,200,1e3],rowsPerPage:r.state.pageSize,onChangeRowsPerPage:r.handleChangeRowsPerPage,page:r.state.currentPage,backIconButtonProps:{"aria-label":"Previous Page"},nextIconButtonProps:{"aria-label":"Next Page"},onChangePage:r.changePage})))},r.handleChangeRowsPerPage=function(e){r.setState({pageSize:e.target.value})},r.changePage=function(e,t){r.setState({currentPage:t})},r.renderHeaders=function(){return W.map((function(e){return n.a.createElement(y.a,{className:"TableHeader",key:e},n.a.createElement(C.a,{variant:"h6"}," ",e," "))}))},r.renderTableBody=function(){var e=r.state.currentPage*r.state.pageSize;return n.a.createElement(w.a,null,Object(s.a)(r.state.personCache.values()).slice(e,e+r.state.pageSize).map((function(e,t){return n.a.createElement(N.a,{key:t},r.renderPersonCells(e))})))},r.renderPersonCells=function(e){return W.map((function(t,a){return n.a.createElement(y.a,{key:a},n.a.createElement(C.a,{variant:"caption"},r.renderPersonCell(e,t)))}))},r.renderPersonCell=function(e,t){switch(t){case"Credit Limit":return r.renderCreditLimitCell(e);case"Origin":return r.renderOriginCell(e);default:return e[t]}},r.renderCreditLimitCell=function(e){return n.a.createElement(f.a,{component:"nav"},e["Credit Limit"].map((function(e,t){return n.a.createElement(g.a,{key:t},n.a.createElement(C.a,{variant:"caption"},e.amount))})))},r.renderOriginCell=function(e){return n.a.createElement(f.a,{component:"nav"},e["Credit Limit"].map((function(e,t){return n.a.createElement(g.a,{key:t},n.a.createElement(C.a,{variant:"caption"},e.source))})))},r.renderDownloadHtmlButton=function(){if(r.personCacheHasData())return n.a.createElement("div",{className:"DownloadFab"},n.a.createElement(D.a,{title:"Download credit data HTML"},n.a.createElement(h.a,{component:"span",color:"primary","aria-label":"Download",onClick:r.downloadHtml},n.a.createElement(H.a,null))))},r.downloadHtml=function(){var e=document.getElementById("personsTable").outerHTML,t=document.createElement("a");t.download="credit_limit_overview.html";var r=new Blob([e],{type:"text/html"});t.href=window.URL.createObjectURL(r),t.click()},r.personCacheHasData=function(){return r.state.personCache.size>0},r.renderErrorMessages=function(){return n.a.createElement(P.a,{className:"ErrorSnackbar",anchorOrigin:{vertical:"bottom",horizontal:"left"},open:r.state.errors&&r.state.errors.length>0,autoHideDuration:6e3,ContentProps:{"aria-describedby":"message-id"},message:r.state.errors?r.state.errors.join(",\n"):"",action:[n.a.createElement(v.a,{key:"close","aria-label":"close",onClick:function(){return r.removeError()},color:"inherit"},n.a.createElement(T.a,null))]})},r.removeError=function(){r.setState({errors:void 0})},r.state={personCache:e.personCache||new Map,currentPage:0,pageSize:5,errors:void 0},r}return Object(d.a)(t,e),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(n.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[67,1,2]]]);
//# sourceMappingURL=main.e52c856e.chunk.js.map